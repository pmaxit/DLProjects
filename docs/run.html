---

title: Generating names dataset


keywords: fastai
sidebar: home_sidebar



nb_path: "notebooks/run.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/run.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we will generate names dataset. Names dataset is supposed to be list of names.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">pytorch_lightning.callbacks.early_stopping</span> <span class="kn">import</span> <span class="n">EarlyStopping</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">file_lists</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;/notebooks/nlp_deeplearning/charmodel/data/first_names.all.txt&#39;</span><span class="p">]</span>

<span class="n">names_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_lists</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">filtered_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\W+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">names_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filtered_name</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">names_list</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;AISHA&#39;, &#39;AISHAH&#39;, &#39;AJAY&#39;, &#39;AAISHA&#39;, &#39;AAISHAH&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-data">Load data<a class="anchor-link" href="#Load-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;/notebooks/Projects/Seq2Seq&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">mllib.seq2seq.namegen</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">dotmap</span> <span class="kn">import</span> <span class="n">DotMap</span>
<span class="kn">from</span> <span class="nn">mllib.seq2seq.model</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pytorch_lightning.loggers</span> <span class="kn">import</span> <span class="n">TensorBoardLogger</span>
<span class="kn">from</span> <span class="nn">pytorch_lightning.callbacks</span> <span class="kn">import</span> <span class="n">ModelCheckpoint</span>
<span class="kn">from</span> <span class="nn">pytorch_lightning.loggers.neptune</span> <span class="kn">import</span> <span class="n">NeptuneLogger</span>
<span class="kn">import</span> <span class="nn">pytorch_lightning</span> <span class="k">as</span> <span class="nn">pl</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dsrc</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">names_list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Modelling">Modelling<a class="anchor-link" href="#Modelling"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hparams</span> <span class="o">=</span> <span class="n">DotMap</span><span class="p">({</span><span class="s1">&#39;vocab_size&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dsrc</span><span class="o">.</span><span class="n">vocab</span><span class="p">),</span> 
          <span class="s1">&#39;embedding_size&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
          <span class="s1">&#39;hidden_size&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
            <span class="s1">&#39;max_len&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
            <span class="s1">&#39;num_layers&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;lr&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Training">Training<a class="anchor-link" href="#Training"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">neptune_logger</span> <span class="o">=</span> <span class="n">NeptuneLogger</span><span class="p">(</span>
    <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;eyJhcGlfYWRkcmVzcyI6Imh0dHBzOi8vYXBwLm5lcHR1bmUuYWkiLCJhcGlfdXJsIjoiaHR0cHM6Ly9hcHAubmVwdHVuZS5haSIsImFwaV9rZXkiOiIwYWY0OTQ4MS03MGY4LTRhNjUtOTFlZC0zZjVjMjlmZGQxNjQifQ==&quot;</span><span class="p">,</span>
    <span class="n">project_name</span><span class="o">=</span><span class="s2">&quot;puneetgirdhar.in/charnn&quot;</span><span class="p">)</span>

<span class="n">tensorboard_logger</span> <span class="o">=</span> <span class="n">TensorBoardLogger</span><span class="p">(</span><span class="s2">&quot;tb_logs&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_model&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>NeptuneLogger will work in online mode
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dsrc</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">after_item</span><span class="o">=</span><span class="n">after_item</span><span class="p">,</span> <span class="n">before_batch</span><span class="o">=</span><span class="n">pad_input_chunk_new</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">n_inp</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># make sure that we use serializing option to instantiate the model</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">RNN</span><span class="p">(</span><span class="n">hparams</span><span class="p">,</span> <span class="n">char2tensor</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">numericalize</span><span class="o">.</span><span class="n">o2i</span><span class="p">)),</span> <span class="n">vocab</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">numericalize</span><span class="o">.</span><span class="n">vocab</span><span class="p">))</span>

<span class="n">checkpoint_callback</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">(</span>
    <span class="n">dirpath</span> <span class="o">=</span> <span class="s1">&#39;./checkpoints&#39;</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{epoch}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">save_top_k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span>
<span class="p">)</span>


<span class="n">trainer</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Trainer</span><span class="p">(</span><span class="n">fast_dev_run</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">neptune_logger</span><span class="p">,</span> <span class="n">auto_lr_find</span><span class="o">=</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span><span class="n">gpus</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span><span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span> <span class="n">checkpoint_callback</span><span class="p">],</span>
                    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>GPU available: True, used: True
TPU available: None, using: 0 TPU cores
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">dls</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>https://app.neptune.ai/puneetgirdhar.in/charnn/e/CHAR-33
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
  | Name      | Type             | Params
-----------------------------------------------
0 | dropout   | Dropout          | 0     
1 | embedding | Embedding        | 3.1 K 
2 | rnn       | LSTM             | 1.1 M 
3 | decoder   | Linear           | 31.3 K
4 | criterion | CrossEntropyLoss | 0     
-----------------------------------------------
1.2 M     Trainable params
0         Non-trainable params
1.2 M     Total params
4.621     Total estimated model params size (MB)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;A&#39;: &#39;AÎहÜÍxxrepxxfakeĢĲहYPशFसÐ&#39;, &#39;B&#39;: &#39;BxxfakeĚŻĖVxxfldŐĂŅĞSČÔÃxxunk&#39;, &#39;R&#39;: &#39;RPŻĲWxxbosZŤÏÔRJYयCF&#39;, &#39;KAR&#39;: &#39;KARxxrepSŁĖZÁÖŽVĂÏxxupÜरŇ&#39;, &#39;TE&#39;: &#39;TEĲČÊŽĖŐÊVAĪÈÐश&#39;, &#39;CHRI&#39;: &#39;CHRIJŤŪOxxrepHŞŤAĂबÜxxunkÌÚ&#39;}
{&#39;A&#39;: &#39;AĚYAH&#39;, &#39;B&#39;: &#39;BBE&#39;, &#39;R&#39;: &#39;REMIE&#39;, &#39;KAR&#39;: &#39;KARLYN&#39;, &#39;TE&#39;: &#39;TEYON&#39;, &#39;CHRI&#39;: &#39;CHRILKEB&#39;}
{&#39;A&#39;: &#39;AरN&#39;, &#39;B&#39;: &#39;BEAGAN&#39;, &#39;R&#39;: &#39;RÁTZ&#39;, &#39;KAR&#39;: &#39;KARTO&#39;, &#39;TE&#39;: &#39;TEF&#39;, &#39;CHRI&#39;: &#39;CHRINER&#39;}
{&#39;A&#39;: &#39;AHER&#39;, &#39;B&#39;: &#39;BAXI&#39;, &#39;R&#39;: &#39;RCPEE&#39;, &#39;KAR&#39;: &#39;KARYA&#39;, &#39;TE&#39;: &#39;TEDA&#39;, &#39;CHRI&#39;: &#39;CHRISTOFER&#39;}
{&#39;A&#39;: &#39;ADHIR&#39;, &#39;B&#39;: &#39;BAÞĢ&#39;, &#39;R&#39;: &#39;RŢA&#39;, &#39;KAR&#39;: &#39;KAR&#39;, &#39;TE&#39;: &#39;TEGEEN&#39;, &#39;CHRI&#39;: &#39;CHRISEPHER&#39;}
{&#39;A&#39;: &#39;AÁS&#39;, &#39;B&#39;: &#39;BYDEEN&#39;, &#39;R&#39;: &#39;RČH&#39;, &#39;KAR&#39;: &#39;KARI&#39;, &#39;TE&#39;: &#39;TEĖ&#39;, &#39;CHRI&#39;: &#39;CHRISHUA&#39;}
{&#39;A&#39;: &#39;ALJT&#39;, &#39;B&#39;: &#39;BYTLAUGH&#39;, &#39;R&#39;: &#39;RŻ&#39;, &#39;KAR&#39;: &#39;KARINE&#39;, &#39;TE&#39;: &#39;TESSOPHE&#39;, &#39;CHRI&#39;: &#39;CHRISPOTH&#39;}
{&#39;A&#39;: &#39;AMIRA&#39;, &#39;B&#39;: &#39;BOX&#39;, &#39;R&#39;: &#39;RVÂET&#39;, &#39;KAR&#39;: &#39;KARRAH&#39;, &#39;TE&#39;: &#39;TE&#39;, &#39;CHRI&#39;: &#39;CHRISTINNA&#39;}
{&#39;A&#39;: &#39;AMBER&#39;, &#39;B&#39;: &#39;BRITTA&#39;, &#39;R&#39;: &#39;RŽ&#39;, &#39;KAR&#39;: &#39;KARO&#39;, &#39;TE&#39;: &#39;TELLI&#39;, &#39;CHRI&#39;: &#39;CHRISTOFORO&#39;}
{&#39;A&#39;: &#39;AZIN&#39;, &#39;B&#39;: &#39;BERCIO&#39;, &#39;R&#39;: &#39;RŞIM&#39;, &#39;KAR&#39;: &#39;KAR&#39;, &#39;TE&#39;: &#39;TEISHA&#39;, &#39;CHRI&#39;: &#39;CHRISTOPHAROUS&#39;}
{&#39;A&#39;: &#39;ABRĪELLE&#39;, &#39;B&#39;: &#39;BUSH&#39;, &#39;R&#39;: &#39;RŢĞÂURG&#39;, &#39;KAR&#39;: &#39;KARTIM&#39;, &#39;TE&#39;: &#39;TEBORY&#39;, &#39;CHRI&#39;: &#39;CHRISTOPHER&#39;}
{&#39;A&#39;: &#39;AÕ&#39;, &#39;B&#39;: &#39;BOÐLR&#39;, &#39;R&#39;: &#39;RĀQAR&#39;, &#39;KAR&#39;: &#39;KARYS&#39;, &#39;TE&#39;: &#39;TE&#39;, &#39;CHRI&#39;: &#39;CHRISTIANA&#39;}
{&#39;A&#39;: &#39;AĢIGASIALO&#39;, &#39;B&#39;: &#39;BĢEWRAN&#39;, &#39;R&#39;: &#39;RŢĞERG&#39;, &#39;KAR&#39;: &#39;KARBJÖRG&#39;, &#39;TE&#39;: &#39;TE&#39;, &#39;CHRI&#39;: &#39;CHRISPUNDER&#39;}
{&#39;A&#39;: &#39;AYSHU&#39;, &#39;B&#39;: &#39;BEK&#39;, &#39;R&#39;: &#39;RNTĞÐUR&#39;, &#39;KAR&#39;: &#39;KARLEYSA&#39;, &#39;TE&#39;: &#39;TEFACHO&#39;, &#39;CHRI&#39;: &#39;CHRISTIANA&#39;}
{&#39;A&#39;: &#39;AŞ&#39;, &#39;B&#39;: &#39;BYGALL&#39;, &#39;R&#39;: &#39;RŢĞRÍÐUR&#39;, &#39;KAR&#39;: &#39;KARPA&#39;, &#39;TE&#39;: &#39;TE&#39;, &#39;CHRI&#39;: &#39;CHRISSE&#39;}
{&#39;A&#39;: &#39;AमFRYD&#39;, &#39;B&#39;: &#39;BBÂKA&#39;, &#39;R&#39;: &#39;RÚDS&#39;, &#39;KAR&#39;: &#39;KARLO&#39;, &#39;TE&#39;: &#39;TESWARAN&#39;, &#39;CHRI&#39;: &#39;CHRISTIANJAMES&#39;}
{&#39;A&#39;: &#39;A&#39;, &#39;B&#39;: &#39;BJÖRN&#39;, &#39;R&#39;: &#39;RलD&#39;, &#39;KAR&#39;: &#39;KARSHAN&#39;, &#39;TE&#39;: &#39;TERIE&#39;, &#39;CHRI&#39;: &#39;CHRISTALIN&#39;}
{&#39;A&#39;: &#39;AHN&#39;, &#39;B&#39;: &#39;BJÖRT&#39;, &#39;R&#39;: &#39;RÓD&#39;, &#39;KAR&#39;: &#39;KARLISHA&#39;, &#39;TE&#39;: &#39;TERMAN&#39;, &#39;CHRI&#39;: &#39;CHRISTOPHER&#39;}
{&#39;A&#39;: &#39;AULAH&#39;, &#39;B&#39;: &#39;BUDUR&#39;, &#39;R&#39;: &#39;RĽ&#39;, &#39;KAR&#39;: &#39;KARLESA&#39;, &#39;TE&#39;: &#39;TEEW&#39;, &#39;CHRI&#39;: &#39;CHRISTION&#39;}
{&#39;A&#39;: &#39;AHN&#39;, &#39;B&#39;: &#39;BJÖRG&#39;, &#39;R&#39;: &#39;RÚE&#39;, &#39;KAR&#39;: &#39;KARLOSARA&#39;, &#39;TE&#39;: &#39;TELAN&#39;, &#39;CHRI&#39;: &#39;CHRISTYN&#39;}
{&#39;A&#39;: &#39;AŪD&#39;, &#39;B&#39;: &#39;BYLEE&#39;, &#39;R&#39;: &#39;RÚDŢY&#39;, &#39;KAR&#39;: &#39;KARIM&#39;, &#39;TE&#39;: &#39;TEKO&#39;, &#39;CHRI&#39;: &#39;CHRISTOPHERJOSE&#39;}
{&#39;A&#39;: &#39;ANA&#39;, &#39;B&#39;: &#39;BYE&#39;, &#39;R&#39;: &#39;RKŞWELLER&#39;, &#39;KAR&#39;: &#39;KARYA&#39;, &#39;TE&#39;: &#39;TEFORD&#39;, &#39;CHRI&#39;: &#39;CHRISTOPHER&#39;}

</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Evaluation">Evaluation<a class="anchor-link" href="#Evaluation"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we can generate some names randomly</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">md</span> <span class="o">=</span> <span class="n">get_first_name_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">md</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RNN(
  (dropout): Dropout(p=0.2, inplace=False)
  (embedding): Embedding(104, 30, scale_grad_by_freq=True)
  (rnn): LSTM(30, 300, num_layers=2, batch_first=True, dropout=0.2)
  (decoder): Linear(in_features=300, out_features=104, bias=True)
  (criterion): CrossEntropyLoss()
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">md</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="s2">&quot;CHRIS&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;CHRISTIE&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

